#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸš€ Running pre-commit checks for better-react workspace..."

# æ£€æŸ¥å­åŒ…å˜æ›´å¹¶è¿è¡Œå¯¹åº”çš„ lint-staged
if git diff --cached --name-only | grep "core/" > /dev/null; then
  echo "ğŸ“¦ Running lint-staged for better-react core package..."
  cd core
  npx lint-staged
  pnpm run type-check
  cd ..
fi

if git diff --cached --name-only | grep "helper/" > /dev/null; then
  echo "ğŸ“¦ Running lint-staged for better-react-helper package..."
  cd helper
  npx lint-staged
  pnpm run type-check
  cd ..
fi

if git diff --cached --name-only | grep "dom/" > /dev/null; then
  echo "ğŸ“¦ Running lint-staged for better-react-dom package..."
  cd dom
  npx lint-staged
  pnpm run type-check
  cd ..
fi

if git diff --cached --name-only | grep "dom-helper/" > /dev/null; then
  echo "ğŸ“¦ Running lint-staged for better-react-dom-helper package..."
  cd dom-helper
  npx lint-staged
  pnpm run type-check
  cd ..
fi

if git diff --cached --name-only | grep "demo/" > /dev/null; then
  echo "ğŸ“¦ Running lint-staged for better-react-demo package..."
  cd demo
  npx lint-staged
  pnpm run type-check
  cd ..
fi

echo "âœ… Pre-commit checks completed!"